@model ResourceViewModel

@{
    ResourceModel fichaRecurso = Model.Resource;
    CommunityModel Comunidad = Html.GetComunidad();
    HeaderModel cabecera = Html.GetCabecera();
    UserIdentityModel IdentidadActual = Html.GetIdentidadActual();

    if (!string.IsNullOrEmpty(Model.Action))
    {
        switch (Model.Action)
        {
            case "report-page":
                <div class="reportPage">
                    <fieldset>
                        <legend class="tituloPanelInterior">@Html.GetText("PERFILBASERECURSOSFICHA", "REPORTAR_RECURSO_INFO")</legend>
                        <textarea style="width:100%"></textarea>
                        @{string funcionReportarAceptar = "AccionRecurso_ReportPage_Aceptar('" + fichaRecurso.ListActions.UrlReportPage + "', '" + fichaRecurso.Key + "')";}
                        <input type="button" onclick="@funcionReportarAceptar" value="@Html.GetText("PERFILBASERECURSOSFICHA", "REPORTAR_RECURSO_ENVIAR")" />
                    </fieldset>
                </div>
                break;
            case "add-personal-space":
                    <div>
                        <div class="compartirRec">
                            <fieldset>
                                <legend class="tituloPanelInterior">@Html.GetText("PERFILBASERECURSOSFICHA", "AGREGARABRPERSONAL")@Model.PersonalSpace</legend>
                            </fieldset>
                            <fieldset>
                                <div>
                                    <div>
                                        <input type="hidden" id="txtSeleccionados" />
                                        <fieldset>
                                            @Html.PartialView("_FichaCategoriaTesauroArbol", Model)
                                        </fieldset>
                                        <p>
                                            @{
                                                string funcionAccionRecurso_AgregarABR_Aceptar = "AccionRecurso_AgregarABR_Aceptar('" + fichaRecurso.ListActions.UrlAddToPersonalSpace + "', '" + fichaRecurso.CompletCardLink + "', '" + fichaRecurso.Key + "')";
                                            }


                                            <input type="button" value="@Html.GetText("PERFILBASERECURSOSFICHA", "AGREGARABRPERSONAL")@Model.PersonalSpace" onclick="@funcionAccionRecurso_AgregarABR_Aceptar" />
                                        </p>
                                    </div>
                                </div>
                            </fieldset>
                        </div>
                    </div>
                    break;
                    case "restore-version":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASE", "DESEARESTAURAR")</legend>
                        </fieldset>
                        <fieldset>
                            <p>
                                @{string funcionAceptarRestaurar = "AccionRecurso_RestaurarVersion_Aceptar('" + fichaRecurso.ListActions.UrlRestoreVersion + "', '" + fichaRecurso.Key + "')";}
                                <input type="button" onclick="@funcionAceptarRestaurar" value="@Html.GetText("COMMON", "SI")" />
                                @{string funcionCancelarRestaurar = "CerrarPanelAccion('despAccionRec_" + fichaRecurso.Key + "')";}
                                <input type="button" onclick="@funcionCancelarRestaurar" value="@Html.GetText("COMMON", "NO")" />
                            </p>
                        </fieldset>
                    </div>
                    break;
                    case "add-categories":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASERECURSOSFICHA", "AGREGARCATEGORIA")</legend>
                            <div class="box">
                                <label>@Html.GetText("CONTROLESSELCATEGORIASBUSQUEDDAS", "SELCATEGORIAS"): </label>
                                <input type="radio" onclick="$('#divSelCatLista').hide(); $('#divSelCatTesauro').show()" name="ModoSelector" checked="checked" />
                                <label for="">@Html.GetText("TESAURO", "VERARBOL")</label>
                                <input type="radio" onclick="$('#divSelCatLista').show(); $('#divSelCatTesauro').hide()" name="ModoSelector" />
                                <label for="">@Html.GetText("TESAURO", "VERLISTA")</label>
                            </div>

                            @{
                                string categoriasSeleccionadas = "";
                                if (fichaRecurso.Categories != null)
                                {
                                    foreach (CategoryModel categoria in fichaRecurso.Categories)
                                    {
                                        categoriasSeleccionadas += categoria.Key + ",";
                                    }
                                }
                            }

                            <input type="hidden" id="txtSeleccionados" value="@categoriasSeleccionadas" />

                            <div id="divSelCatTesauro" class="box">
                                @Html.PartialView("_FichaCategoriaTesauroArbol", Model)

                            </div>
                            <div style="display: none;" id="divSelCatLista">
                                <fieldset>
                                    <p>
                                        <input type="text" onkeydown="javascript:if(event.which || event.keyCode){if ((event.which == 13) || (event.keyCode == 13)) {return false;}}" onkeyup="javascript:MVCFiltrarListaSelCat(this, 'despAccionRec_@fichaRecurso.Key');" class="filtroRapido" />
                                        <input type="text" class="findAction" />
                                    </p>
                                </fieldset>
                                @Html.PartialView("_FichaCategoriaTesauroLista", Model)
                            </div>
                        </fieldset>
                        <fieldset>
                            <p>
                                @{
                                    string funcionAgregarCategoriasAceptar = "AccionRecurso_AgregarCategorias_Aceptar('" + fichaRecurso.ListActions.UrlAddCategories + "', '" + fichaRecurso.Key + "', $('#despAccionRec_" + fichaRecurso.Key + "').find('#txtSeleccionados').val(), " + Model.AllowEditCategories.ToString().ToLower() + ", '" + fichaRecurso.UrlSearch + "/" + Html.GetText("URLSEM", "CATEGORIA") + "')";
                                }
                                <input type="button" value="@Html.GetText("COMMON", "ACEPTAR")" onclick="@funcionAgregarCategoriasAceptar" />
                            </p>
                        </fieldset>
                    </div>
                    break;
                    case "add-tags":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASERECURSOSFICHA", "AGREGARTAG")</legend>
                            @if (!Model.AllowEditTags)
                        {
                                <div class="group etiquetas">
                                    <p>@Html.GetText("COMMON", "ETIQUETAS"): </p>
                                    <ul>
                                        @{
                                            int cont = 0;
                                            foreach (string etiqueta in fichaRecurso.Tags)
                                            {
                                                string separador = "";
                                                if (cont > 0) { separador = ", "; }
                                                <li>@separador<label>@etiqueta</label></li>
                                                cont++;
                                            }
                                        }
                                    </ul>
                                </div>
                                            }
                            <fieldset>
                                <p class="textarea"></p>
                                <div onclick="$(this).children('#textBoxTagsNuevos_@fichaRecurso.Key').focus()" class="autocompletar">
                                    <span class="contenedor"></span>
                                    @{
                                        string tagsEditar = "";
                                        if (Model.AllowEditTags && fichaRecurso.Tags != null)
                                        {
                                            foreach (string etiqueta in fichaRecurso.Tags)
                                            {
                                                tagsEditar += etiqueta + ",";
                                            }
                                        }
                                    }
                                    <input type="text" onfocus="CrearAutocompletarTags(this, $('input#inpt_urlServicioAutocompletar').val(), '@Comunidad.Key', $('input#inpt_bool_esMyGnoss').val(), $('input#inpt_bool_estaEnProyecto').val(), $('input#inpt_bool_esUsuarioInvitado').val(), '@IdentidadActual.KeyIdentity');" class="txtAutocomplete" id="textBoxTagsNuevos_@fichaRecurso.Key" value="@tagsEditar" />
                                    @{
                                        string txtHack = "textBoxTagsNuevos_" + fichaRecurso.Key + "_Hack";
                                    }
                                    <input type="hidden" id="@txtHack" />
                                </div>
                                <script type="text/javascript">
                                    PintarTags($('#textBoxTagsNuevos_@fichaRecurso.Key'));
                                </script>
                            </fieldset>
                            <fieldset>
                                <p>
                                    @{
                                        string funcionAgregarTagsAceptar = "AccionRecurso_AgregarTags_Aceptar('" + fichaRecurso.ListActions.UrlAddTags + "', '" + fichaRecurso.Key + "', $('#textBoxTagsNuevos_" + fichaRecurso.Key + "_Hack').val(), " + Model.AllowEditTags.ToString().ToLower() + ", '" + fichaRecurso.UrlSearch + "/" + Html.GetText("URLSEM", "TAG") + "')";
                                    }
                                    <input type="button" value="@Html.GetText("COMMON", "ACEPTAR")" onclick="@funcionAgregarTagsAceptar" />
                                </p>
                            </fieldset>
                        </fieldset>
                    </div>
                    break;
                    case "share":
                    <div>
                        <div class="compartirRec">
                            <fieldset>
                                @{
                                    string textoCompartir = Html.GetText("CONTROLESDOCUMENTACION", "COMPARTIRRECURSO");
                                    if (fichaRecurso.TypeDocument == ResourceModel.DocumentType.Pregunta)
                                    {
                                        textoCompartir = Html.GetText("CONTROLESDOCUMENTACION", "COMPARTIRPREGUNTA");
                                    }
                                }
                                <legend class="tituloPanelInterior">@textoCompartir</legend>
                                @if (fichaRecurso.Shareds != null && fichaRecurso.Shareds.Count > 0)
                                {
                                    <div class="box">
                                        <p>
                                            <label>@Html.GetText("CONTROLESDOCUMENTACION", "COMUNIDADESYACOMPARTIDO");</label>
                                            @foreach (ResourceModel.SharedBRModel brCompartido in fichaRecurso.Shareds)
                                            {
                                                <label class="destacado">@brCompartido.Name</label>
                                            }
                                        </p>
                                    </div>
                                }
                                <p>
                                    @{
                                        string mensajeExplicativo = "";
                                        if (fichaRecurso.TypeDocument == ResourceModel.DocumentType.Pregunta)
                                        {
                                            if (fichaRecurso.Private)
                                            {
                                                mensajeExplicativo = Html.GetText("CONTROLESDOCUMENTACION", "PUEDESCOMPARTIRPREGUNTACONPRIVADAS");
                                            }
                                            else
                                            {
                                                mensajeExplicativo = Html.GetText("CONTROLESDOCUMENTACION", "PUEDESCOMPARTIRPREGUNTACON");
                                            }
                                        }
                                        else
                                        {
                                            if (fichaRecurso.Private)
                                            {
                                                mensajeExplicativo = Html.GetText("CONTROLESDOCUMENTACION", "PUEDESCOMPARTIRRECURSOCONPRIVADAS");
                                            }
                                            else
                                            {
                                                mensajeExplicativo = Html.GetText("CONTROLESDOCUMENTACION", "PUEDESCOMPARTIRRECURSOCON");
                                            }
                                        }

                                        if (Model.IsDocumentEditor && (Comunidad.AccessType.Equals(CommunityModel.TypeAccessProject.Private) || Comunidad.AccessType.Equals(CommunityModel.TypeAccessProject.Reserved)))
                                        {
                                            mensajeExplicativo += Html.GetText("CONTROLESDOCUMENTACION", "PUEDESDECIDIRPRIVACIDAD");
                                        }
                                        mensajeExplicativo += Html.GetText("CONTROLESDOCUMENTACION", "NOOLVIDES");

                                        if (Model.ResourceBases.Count == 0)
                                        {
                                            mensajeExplicativo = Html.GetText("CONTROLESDOCUMENTACION", "NOCOMPARTIRPUEDES");
                                        }

                                    }
                                    <label>@Html.Raw(mensajeExplicativo)</label>
                                </p>
                            </fieldset>
                            @if (Model.ResourceBases.Count > 0)
                        {
                                <fieldset>
                                    <p>
                                        <label>@Html.GetText("CONTROLESDOCUMENTACION", "COMPARTIREN")</label>
                                        @{
                                            string funcionAccionRecurso_Compartir_Cambiar = "AccionRecurso_Compartir_Cambiar('" + fichaRecurso.ListActions.UrlLoadActionShareChange + "', '" + fichaRecurso.Key + "', '" + IdentidadActual.KeyPerson + "', $('input#inpt_urlServicioAutocompletar').val())";
                                        }
                                        <select id="ddlCompartir" onchange="@funcionAccionRecurso_Compartir_Cambiar">
                                            @foreach (Guid baseRecursosID in Model.ResourceBases.Keys)
                                            {
                                                <option value="@baseRecursosID" rel="@Model.ResourceBases[baseRecursosID].Value">@Model.ResourceBases[baseRecursosID].Key</option>
                                            }
                                        </select>
                                    </p>
                                </fieldset>

                                <fieldset>
                                    <div>
                                        <div>
                                            <input type="hidden" id="txtSeleccionados" />
                                            <fieldset id="divSelCatTesauro">
                                                @Html.PartialView("_FichaCategoriaTesauroArbol", Model)
                                            </fieldset>

                                            @if (Model.IsDocumentEditor && (Comunidad.AccessType == CommunityModel.TypeAccessProject.Private || Comunidad.AccessType == CommunityModel.TypeAccessProject.Reserved))
                                            {
                                                string functionAjustarPrivacidadRecurso = "AccionRecurso_Compartir_AjustarPrivacidadRecurso('" + fichaRecurso.Key + "', this);";

                                                <div id="panEditoresLectores">
                                                    <div id="panEditores">
                                                        <fieldset>
                                                            <legend>@Html.GetText("PERFILBASERECURSOEDITAR", "INICIOEDITORES")</legend>
                                                            <ul class="radioList">
                                                                <li>
                                                                    <input type="radio" id="rbEditoresYo" value="rbEditoresYo" checked="checked" name="editores" onclick="@functionAjustarPrivacidadRecurso" /><label>@Html.GetText("PERFILBASERECURSOEDITAR", "SOLOYO")</label>
                                                                </li>
                                                                <li>
                                                                    <input type="radio" id="rbEditoresOtros" value="rbEditoresOtros" name="editores" onclick="@functionAjustarPrivacidadRecurso" /><label>@Html.GetText("PERFILBASERECURSOEDITAR", "PERSONASESPECIFICAS")</label>
                                                                </li>
                                                            </ul>
                                                            <div id="divContEditores" class="oculto">
                                                                <fieldset>
                                                                    <p></p>
                                                                    <p>@Html.GetText("PERFILBASERECURSOEDITAR", "INFOEDITORES")</p>
                                                                    <fieldset class="filtroRapido">
                                                                        <p>
                                                                            <input type="text" autocomplete="off" class="filtroFaceta ac_input" id="txtEditores_@fichaRecurso.Key" />
                                                                            <span class="searchButton"></span>
                                                                        </p>
                                                                    </fieldset>
                                                                    <input type="hidden" id="txtHackEditores_@fichaRecurso.Key" />
                                                                    <p></p>
                                                                </fieldset>
                                                            </div>
                                                            <div class="editorLector">
                                                                <div id="panContenedorEditores" style="display: none"></div>
                                                            </div>
                                                        </fieldset>
                                                    </div>
                                                    <div id="panLectores" style="display:none;">
                                                        <fieldset>
                                                            <legend>@Html.GetText("PERFILBASERECURSOEDITAR", "INICIOLECTORES")</legend>
                                                            <ul class="radioList">
                                                                <li>
                                                                    <input type="radio" id="rbLectoresComunidad" value="rbLectoresComunidad" checked="checked" name="lectores" onclick="@functionAjustarPrivacidadRecurso" /><label>@Html.GetText("PERFILBASERECURSOEDITAR", "LECTORESCOMUNIDAD")</label>
                                                                </li>
                                                                <li>
                                                                    <input type="radio" id="rbLectoresEditores" value="rbLectoresEditores" name="lectores" onclick="@functionAjustarPrivacidadRecurso" /><label>@Html.GetText("PERFILBASERECURSOEDITAR", "LECTORESEDITORES")</label>
                                                                </li>
                                                                <li>
                                                                    <input type="radio" id="rbLectoresEspecificos" value="rbLectoresEspecificos" name="lectores" onclick="@functionAjustarPrivacidadRecurso" /><label>@Html.GetText("PERFILBASERECURSOEDITAR", "LECTORESESPECIFICOS")</label>
                                                                </li>
                                                            </ul>
                                                            <div id="divContLectores" class="oculto">
                                                                <fieldset>
                                                                    <p></p>
                                                                    <p></p>
                                                                    <fieldset class="filtroRapido">
                                                                        <p>
                                                                            <input type="text" autocomplete="off" class="filtroFaceta ac_input" id="txtLectores_@fichaRecurso.Key" />
                                                                            <span class="searchButton"></span>
                                                                        </p>
                                                                    </fieldset>
                                                                    <input type="hidden" id="txtHackLectores_@fichaRecurso.Key" />
                                                                    <p></p>
                                                                </fieldset>
                                                            </div>
                                                            <div class="editorLector">
                                                                <div id="panContenedorLectores" style="display: none"></div>
                                                            </div>
                                                        </fieldset>
                                                    </div>
                                                </div>
                                                <script type="text/javascript">
                                                    AccionRecurso_Compartir_GenerarAutocompletar('@fichaRecurso.Key', '@IdentidadActual.KeyPerson', $('input#inpt_urlServicioAutocompletar').val());
                                                </script>
                                            }
                                            <p>
                                                @{
                                                    string funcionAccionRecurso_Compartir_Agregar = "AccionRecurso_Compartir_Agregar('" + fichaRecurso.Key + "')";
                                                }
                                                <input type="button" value="@Html.GetText("AGREGA_A_BR", "AGREGA_A_BR")" onclick="@funcionAccionRecurso_Compartir_Agregar" />
                                            </p>
                                        </div>
                                    </div>
                                </fieldset>
                                                    }
                            <div id="panContenedorBRAgregadas" style="display: none">
                                <fieldset>
                                    <label>@Html.GetText("ANYADIRGNOSS", "SE_GUARDARA_EN")</label>
                                    <div>
                                        <ul class="icoEliminar"></ul>
                                    </div>
                                </fieldset>
                            </div>

                            <fieldset id="panBotonAceptar" style="display: none">
                                <div>
                                    @*<p>Este recurso dejará de ser privado para editores y se hará público con todo su historial, versiones y comentarios.</p>*@
                                    @{
                                        string funcionAccionRecurso_Compartir_Aceptar = "AccionRecurso_Compartir_Aceptar('" + fichaRecurso.ListActions.UrlShare + "', '" + fichaRecurso.Key + "', '" + fichaRecurso.CompletCardLink + "')";
                                    }
                                    <input type="button" onclick="@funcionAccionRecurso_Compartir_Aceptar" value="@Html.GetText("COMMON", "ACEPTAR")" />

                                </div>
                            </fieldset>
                        </div>
                    </div>
                    break;
                    case "duplicate":
                    <div>
                        <div class="compartirRec">
                            <fieldset>
                                @{
                                    string textoDuplicar = Html.GetText("CONTROLESDOCUMENTACION", "DUPLICARRECURSO");
                                    if (fichaRecurso.TypeDocument == ResourceModel.DocumentType.Pregunta)
                                    {
                                        textoDuplicar = Html.GetText("CONTROLESDOCUMENTACION", "DUPLICARPREGUNTA");
                                    }
                                }
                                <legend class="tituloPanelInterior">@textoDuplicar</legend>
                                @if (fichaRecurso.Duplicates != null && fichaRecurso.Duplicates.Count > 0)
                                {
                                    <div class="box">
                                        <p>
                                            <label>@Html.GetText("CONTROLESDOCUMENTACION", "COMUNIDADESYADUPLICADO");</label>
                                            @foreach (ResourceModel.SharedBRModel brCompartido in fichaRecurso.Duplicates)
                                            {
                                                <label class="destacado">@brCompartido.Name</label>
                                            }
                                        </p>
                                    </div>
                                }
                            </fieldset>
                            <fieldset>
                                <p>
                                    <label>@Html.GetText("CONTROLESDOCUMENTACION", "DUPLICAREN")</label>
                                    <select id="ddlCompartir">
                                        @foreach (string urlComunidad in Model.UserComunities.Keys)
                                        {
                                            <option value="@urlComunidad" rel="@Model.UserComunities[urlComunidad].Value">@Model.UserComunities[urlComunidad].Key</option>
                                        }
                                    </select>
                                </p>
                            </fieldset>

                            <fieldset id="panBotonAceptar">
                                <div>
                                    @{
                                        string funcionAccionRecurso_Duplicar_Aceptar = "AccionRecurso_Duplicar_Aceptar('" + fichaRecurso.ListActions.UrlDuplicate + "', '" + fichaRecurso.Key + "', '" + fichaRecurso.CompletCardLink + "')";
                                    }
                                    <input type="button" onclick="@funcionAccionRecurso_Duplicar_Aceptar" value="@Html.GetText("COMMON", "ACEPTAR")" />

                                </div>
                            </fieldset>
                        </div>
                    </div>
                    break;
                    case "send-newsletter":
                    <div>
                        <fieldset>
                            <p>@Html.GetText("PERFILBASERECURSOSFICHA", "PEGUNTAENVIARCORREOTODOSUSUARIO")</p>
                        </fieldset>
                        <fieldset>
                            <p>
                                @foreach (KeyValuePair<string, string> idioma in cabecera.Languajes)
                                {
                                    string funcionEnviarNewsletterIdioma = "AccionRecurso_EnviarNewsletter_Aceptar('" + idioma.Key + "', '" + fichaRecurso.ListActions.UrlSendNewsletter + "', '" + fichaRecurso.Key + "')";

                                    <input type="button" value="@idioma.Value" onclick="@funcionEnviarNewsletterIdioma" />
                                }
                            </p>
                            <p>
                                @{string funcionCancelarEnviarNewsletter = "CerrarPanelAccion('despAccionRec_" + fichaRecurso.Key + "')";}
                                <input type="button" value="@Html.GetText("PERFILBASE", "CANCELAR")" onclick="@funcionCancelarEnviarNewsletter" />
                            </p>
                        </fieldset>
                    </div>
                    break;
                    case "send-newsletter-groups":
                    <div>
                        <fieldset>
                            <p>@Html.GetText("INVITACIONES", "SELECCIONAGRUPOS")</p>
                            <fieldset class="filtroRapido">
                                <p>
                                    <input type="text" autocomplete="off" class="filtroFaceta ac_input" id="txtFiltroGrupos_@fichaRecurso.Key" />
                                    <input type="hidden" id="txtFiltroGrupos_@{@fichaRecurso.Key}_Hack" />
                                    <span class="searchButton"></span>
                                </p>
                            </fieldset>
                            <input type="hidden" id="txtHackGrupos_@fichaRecurso.Key" />
                            <p></p>
                        </fieldset>
                        <div style="display:none" id="contenedorEnviar_@fichaRecurso.Key">
                            <fieldset>
                                <div id="panContenedorGrupos_@fichaRecurso.Key">
                                    <p>@Html.GetText("PERFILBASERECURSOSFICHA", "NEWSLETERGRUPOS")</p>
                                </div>
                            </fieldset>
                            <fieldset>
                                <p>@Html.GetText("PERFILBASERECURSOSFICHA", "PEGUNTAENVIARCORREOTODOSMIEMBROSGRUPOS")</p>
                            </fieldset>
                            <fieldset>
                                <p>
                                    @foreach (KeyValuePair<string, string> idioma in cabecera.Languajes)
                                    {
                                        string funcionEnviarNewsletterGrupoIdioma = "AccionRecurso_EnviarNewsletterGrupos_Aceptar('" + idioma.Key + "', '" + fichaRecurso.ListActions.UrlSendNewsletterGroups + "', '" + fichaRecurso.Key + "', $('#txtHackGrupos_" + fichaRecurso.Key + "').val())";

                                        <input type="button" value="@idioma.Value" onclick="@funcionEnviarNewsletterGrupoIdioma" />
                                    }
                                </p>
                                <p>
                                    @{string funcionCancelarEnviarNewsletterGrupo = "CerrarPanelAccion('despAccionRec_" + fichaRecurso.Key + "')";}
                                    <input type="button" value="@Html.GetText("PERFILBASE", "CANCELAR")" onclick="@funcionCancelarEnviarNewsletterGrupo    ;" />
                                </p>
                            </fieldset>

                            <script type="text/javascript">
                                CargarAutocompletarGrupos('txtFiltroGrupos_@fichaRecurso.Key', 'txtHackGrupos_@fichaRecurso.Key', '@IdentidadActual.KeyIdentity', '@IdentidadActual.KeyMetaProyectIdentity', '@IdentidadActual.KeyOrganization', '@Comunidad.Key', $('input#inpt_urlServicioAutocompletar').val());

                                $('#txtFiltroGrupos_@fichaRecurso.Key').result(function (event, data, formatted) { seleccionarAutocompletar(data[0], data[1], 'panContenedorGrupos_@fichaRecurso.Key', 'txtHackGrupos_@fichaRecurso.Key', 'contenedorEnviar_@fichaRecurso.Key', 'txtFiltroGrupos_@fichaRecurso.Key'); })
                            </script>
                        </div>
                    </div>
                    break;
                    case "link-resource":
                    <fieldset>
                        <legend>@Html.GetText("VINCULACIONDOCUMENTACION", "INFOVINCULAR")</legend>
                        <div class="box">
                            <p>@Html.GetText("VINCULACIONDOCUMENTACION", "INFOVINCULAREXTENSO", (string)Comunidad.Name)</p>

                        </div>
                        <fieldset class="labels">
                            <p>
                                <label>@Html.GetText("VINCULACIONDOCUMENTACION", "INFOVINCULARURL")</label>
                                <input type="text" class="text big" id="txtUrlDocVinculado_@fichaRecurso.Key" />
                            </p>
                        </fieldset>
                        <fieldset>
                            <p>
                                @{string funcionVincularAceptar = "AccionRecurso_Vincular_Aceptar('" + fichaRecurso.ListActions.UrlLinkResource + "','" + fichaRecurso.ListActions.UrlLoadLinkedResources + "', '" + fichaRecurso.Key + "')";}
                                <input type="button" onclick="@funcionVincularAceptar" value="@Html.GetText("VINCULACIONDOCUMENTACION", "VINCULAR")" />
                            </p>
                        </fieldset>
                    </fieldset>
                    break;
                    case "certify":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASERECURSOSFICHA", "CERTIFICARDOC")</legend>
                            <br />
                            <p>
                                <select id="comboCertificado_@fichaRecurso.Key">
                                    <option value="@Guid.Empty">No certificado</option>
                                    @foreach (Guid certificacionID in Comunidad.ListaCertificaciones.Keys)
                                    {
                                        string selected = "";
                                        if (certificacionID == fichaRecurso.Certification.Key)
                                        {
                                            selected = "SELECTED=\"selected\"";
                                        }
                                        <option @selected value="@certificacionID">@Comunidad.ListaCertificaciones[certificacionID]</option>
                                    }
                                </select>
                            </p>
                            <p>
                                @{string funcionCertificarAceptar = "AccionRecurso_Certificar_Aceptar('" + fichaRecurso.ListActions.UrlCertify + "', '" + fichaRecurso.Key + "', '" + Html.GetText("PERFILBASERECURSOSFICHA", "RECURSOCERTIFICADO") + "')";}
                                <input type="button" value="@Html.GetText("PERFILBASERECURSOSFICHA", "CERTIFICAR")" onclick="@funcionCertificarAceptar" />
                            </p>
                        </fieldset>
                    </div>
                    break;
                    case "delete":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASE", "ELIMINARUNO", fichaRecurso.Title)</legend>
                            <br />
                            <div id="eliminar_@fichaRecurso.Key">
                                <p>
                                    @if (Model.IsDocumentEditor)
                                    {
                                        string funcionEliminarSelectivo = "DesplegarAccionMVC('" + fichaRecurso.ListActions.UrlLoadActionDeleteSelective + "', this, 'despAccionRec_" + fichaRecurso.Key + "', '')";
                                        <input type="button" value="@Html.GetText("PERFILBASERECURSOSFICHA", "ELIMINARSELECTIVO")" onclick="@funcionEliminarSelectivo" />
                                    }
                                    @{
                                        string funcionEliminarAceptar = "AccionRecurso_Eliminar_Aceptar('" + fichaRecurso.ListActions.UrlDelete + "', '" + fichaRecurso.Key + "')";
                                        string funcionEliminarCancelar = "CerrarPanelAccion('despAccionRec_" + fichaRecurso.Key + "')";
                                    }
                                    <input type="button" value="@Html.GetText("COMMON", "SI")" onclick="@funcionEliminarAceptar" />

                                    <input type="button" value="@Html.GetText("COMMON", "NO")" onclick="@funcionEliminarCancelar" />
                                </p>
                            </div>
                        </fieldset>
                    </div>
                    break;
                    case "delete-selective":
                    <div>
                        <fieldset>
                            <legend>@Html.GetText("PERFILBASE", "INFORMACIONELIMINARRECURSO")</legend>
                            <ul class="radioList">
                                @foreach (ResourceModel.SharedBRModel baseRecursos in fichaRecurso.Shareds)
                                {
                                    <li>
                                        @{
                                            string disabled = "";
                                            if (baseRecursos.ProyectKey == Comunidad.Key)
                                            {
                                                disabled = "disabled=\"disabled\" checked=\"checked\"";
                                            }
                                            <input type="checkbox" name="@baseRecursos.Key" id="@baseRecursos.Key" @disabled />
                                        }
                                        <label for="@baseRecursos.Key">@baseRecursos.Name</label>
                                    </li>
                                            }
                            </ul>
                            <div id="eliminarSelectivo_@fichaRecurso.Key">
                                <p>
                                    @{string funcionEliminarSelectivoAceptar = "AccionRecurso_EliminarSelectivo_Aceptar('" + fichaRecurso.ListActions.UrlDeleteSelective + "', '" + fichaRecurso.Key + "')";}
                                    <input type="button" onclick="@funcionEliminarSelectivoAceptar" value="@Html.GetText("PERFILBASERECURSOSFICHA", "ELIMINAR")" />
                                </p>
                            </div>
                        </fieldset>
                    </div>
                    break;
                    }
                    }
                    }


                    @helper PintarCategoria(CategoryModel pCategoriaTesauro, int pNivel)
                    {
ResourceModel fichaRecurso = Model.Resource;
bool tieneHijos = ((List<CategoryModel>)Model.Categories).Count(cat => cat.ParentCategoryKey == pCategoriaTesauro.Key) > 0;

string nombre = "";
for (int i = 0; i < pNivel; i++)
{
    nombre += "&nbsp;";
}
nombre += pCategoriaTesauro.Name;
    <option value="@pCategoriaTesauro.Key">@Html.Raw(nombre)</option>
if (tieneHijos)
{
    foreach (CategoryModel categoria in ((List<CategoryModel>)Model.Categories).Where(cat => cat.ParentCategoryKey == pCategoriaTesauro.Key).OrderBy(cat => cat.Order))
    {
            @PintarCategoria(categoria, pNivel + 1);
        }
    }
}

