@*[security|||course|||materialeducativo]*@
@model ResourceViewModel
@{
    ResourceModel FichaDocumento = Model.Resource;
    SemanticResourceModel semCmsModel = Model.SemanticFrom;
    CommunityModel Comunidad = ViewBag.Comunidad;
    UserIdentityModel IdentidadActual = ViewBag.IdentidadActual;
    UserProfileModel perfil = ViewBag.Perfil;
	ViewBag.PintarH1 = false;

    ViewBag.BodyClass = "page-resource layout02 listadoComunidad comGnoss course ficha-cursos operativacursillos semanticoResource " + FichaDocumento.RdfType + "Resource";

    if (FichaDocumento.ItemLinkedFotoVersion != 0 && !string.IsNullOrEmpty
        (FichaDocumento.ItemLinked.ToString()) && FichaDocumento.ItemLinked != Guid.Empty)
    {
        ViewBag.ListaCSS.Add(ViewBag.BaseUrlContent + "/" + Es.Riam.Util.UtilArchivos.ContentOntologias + "/Archivos/" + FichaDocumento.ItemLinked.ToString().Substring(0, 3) + "/" + FichaDocumento.ItemLinked.ToString() + ".css?v=" + FichaDocumento.ItemLinkedFotoVersion);
        ViewBag.ListaJS.Add(ViewBag.BaseUrlContent + "/" + Es.Riam.Util.UtilArchivos.ContentOntologias + "/Archivos/" + FichaDocumento.ItemLinked.ToString().Substring(0, 3) + "/" + FichaDocumento.ItemLinked.ToString() + ".js?v=" + FichaDocumento.ItemLinkedFotoVersion);
    }
}

@section breadcrumb{
    <div class="breadcrumb" id="breadcrumb">
        <div class="box">
            <p>@Html.GetText("COMMON", "ESTASEN")</p>
            <ol>
                <li><a href="@Comunidad.Url"><strong>@Html.GetText("COMMON", "HOME")</strong></a></li>
                @{
                    string urlPestanya = Comunidad.Url + "/" + ViewBag.NombreUrlPestanya;
                    string nombrePestanya = ViewBag.NombrePestanya;
                }
                <li><a href="@urlPestanya">@nombrePestanya</a></li>
                <li>@FichaDocumento.Title</li>
            </ol>
        </div>
    </div>
}

<div id="col02" class="col col-xs-12 col-md-9">
    <div>
        <div>
            @if (!FichaDocumento.LastVersion.Equals(FichaDocumento.Key))
            {
                <div>
                    <div class="group utils-1 noUltVer">
                        <img src="@ViewBag.BaseUrlStatic/img/comunidades/icoNoVigilado.gif" />
                        <p>@Html.Raw(Html.GetText("PERFILBASERECURSOSFICHA", "NOULTIMAVERSION", (string)ViewBag.UrlPagina.Replace(FichaDocumento.Key.ToString(), FichaDocumento.LastVersion.ToString())))</p>      
	                </div>
                </div>
            }
            <div typeof="sioc_t:Item" xmlns:owl="http://www.w3.org/2002/07/owl#" xmlns:sioc_t="http://rdfs.org/sioc/types#" xmlns:foaf="http://xmlns.com/foaf/0.1/" xmlns:dcterms="http://purl.org/dc/terms/" xmlns:sioc="http://rdfs.org/sioc/ns#" class="resource resource-main">
                <div class="box description">
                    <div class="wrapDescription">
                        @{
                            string titulo = FichaDocumento.Title;
                            string rdfaTitulo = "";
                            SemanticPropertyModel propTitulo = propTitulo = Model.SemanticFrom.GetPropertyByPath("http://purl.org/dc/elements/1.1/title");
                            if (propTitulo != null)
                            {
                                titulo = propTitulo.FirstPropertyValue.Value;
                                rdfaTitulo = propTitulo.GetRDFA();
                            }

                            string claseCssAsignatura = "";
							@*claseCssAsignatura = Es.Riam.Util.UtilCadenas.RemoveAccentsWithRegEx(titulo.Substring(0, titulo.IndexOf(" ")).ToLower());*@
							
                        }
						<div class="group title groupTitleCabecera">
							<p class="pageTitle"><a href="https://didactalia.net/comunidad/materialeducativo/cursos">@Html.Translate("Cursos de didactalia")</a></p>
							<h1  property="dcterms:title" class="@claseCssAsignatura">
								<span class="icono"></span>
								<span @rdfaTitulo>@titulo</span>        
							</h1>
							<p class="resourceType semantico @FichaDocumento.RdfType">
								<span>tipo de documento</span>
								<a>@FichaDocumento.RdfTypeName</a>
							</p>
						</div>
                             
                        @if (FichaDocumento.Publisher != null)
                        {
							<div class="componenteAutorUtilsAccionesRedes clearfix">
								<div class="group author">
									@Html.PartialView("_FichaPublicador", FichaDocumento)
									@if (FichaDocumento.Publisher.Key != IdentidadActual.KeyIdentity && FichaDocumento.Publisher.TypeProfile != ProfileType.Organization && FichaDocumento.Publisher.TypeProfile != ProfileType.ProfessionalCorporate)
         {
										<p class="acc_seguir @(FichaDocumento.Publisher.Actions != null && FichaDocumento.Publisher.Actions.FollowingProfile ? "activo" : "")">
										@if (!IdentidadActual.IsGuestIdentity)
          {
              if (FichaDocumento.Publisher.Actions != null && FichaDocumento.Publisher.Actions.FollowingProfile)
              {
												<a onclick="Didactalia_AccionPerfil_NoSeguir(this, '@FichaDocumento.Publisher.ListActions.UrlUnfollow')">@Html.GetText("COMMON", "NOSEGUIR")<span class="icono"></span></a>
              }
              else
              {
												<a onclick="Didactalia_AccionPerfil_Seguir(this, '@FichaDocumento.Publisher.ListActions.UrlFollow')">@Html.GetText("COMMON", "SEGUIR")<span class="icono"></span></a>
              }
          }
										</p>
         }
								</div>
								<div class="resource-utils clearfix">
									<ul>
										@Html.PartialView("_FichaVotos", FichaDocumento.Votes)
										@{
         string textoVisitas = Html.GetText("LISTARECURSOS", "VISITAS");
         if (FichaDocumento.NameImage == "video" || FichaDocumento.NameImage == "audio")
         {
             textoVisitas = Html.GetText("LISTARECURSOS", "REPRODUCCIONES");
         }
										}
										@if (!Model.HideWebsiteVisits)
          {
											<li class="visitas">
												<span class="literal">@textoVisitas </span>
												<strong>@FichaDocumento.NumVisits</strong>
											</li>
          }
										<li class="comentarios">
											<span class="literal">@Html.GetText("CONFIGURACIONFACETADO", "CONTCOMR")</span>
											<strong>@FichaDocumento.NumComments</strong>
										</li>
										@if ((FichaDocumento.Actions != null && FichaDocumento.Actions.AddToMyPersonalSpace) || FichaDocumento.IsInMyPersonalSpace)
          {
              string accionAgregarAMiEspacio = "";
              if (!FichaDocumento.IsInMyPersonalSpace)
              {
                  if (!IdentidadActual.IsGuestUser)
                  {
													@*FichaDocumento.ListActions.UrlLoadActionAddToPersonalSpace*@
                      accionAgregarAMiEspacio = "DesplegarAccionMVC('" + FichaDocumento.CompletCardLink + "/load-action/add-personal-space', this, 'despAccionRec_" + FichaDocumento.Key + "', 'AccionRecurso_AgregarABR');operativaVentanaModalEspacioPersonal($(this));";
                  }
                  else
                  {
                      accionAgregarAMiEspacio = "lanzarRegistroAccionInvitado.init();";
                  }
              }
											<li class="guardar @(FichaDocumento.IsInMyPersonalSpace ? "activo" : "")">
												<a onclick="@accionAgregarAMiEspacio" data-toggle="modal" data-target="#recursoModal_@FichaDocumento.Key" class="guardar_@FichaDocumento.Key">
													<span class="literal">@Html.GetText("PERFILBASERECURSOSFICHA", "AGREGARABRPERSONAL")</span>
												</a>
											</li>
          }
										@Html.PartialView("_FichaAccionesMenu", Model)
									</ul>
								</div>
							</div>
                        }
                        @if (!Model.HideUtilsResource)
                        {
                            <div id="panUtils1" class="group utils-1 js-activado">
                                <p class="info"><strong>@Html.GetText("PERFILBASERECURSOSFICHA", "ACERCADEESTERECURSO")</strong></p>
                                
                                @if (FichaDocumento.Certification.Key != Guid.Empty)
                                {
                                    <div id="contCertificado">
                                        <p class="certificado">
                                            @Html.GetText("PERFILBASERECURSOSFICHA", "RECURSOCERTIFICADO"):
                                            <strong>@MvcHtmlString.Create(FichaDocumento.Certification.Value)</strong>
                                        </p>
                                    </div>
                                }
								
                            </div>
                        }

                        <!-- MAQUETACION PERSONALIZADA BACK -->

                        @{                           
                            SemanticPropertyModel propValorPrecio = Model.SemanticFrom.GetPropertyByPath("http://purl.org/goodrelations/v1#hasPriceSpecification");
                            SemanticPropertyModel propValorFormato = Model.SemanticFrom.GetPropertyByPath("http://purl.org/dc/elements/1.1/format");
                            SemanticPropertyModel propValorImagenCurso = Model.SemanticFrom.GetPropertyByPath("http://onto.didactalia.net/emlo#image");
                            SemanticPropertyModel propValorDuracion = Model.SemanticFrom.GetPropertyByPath("http://purl.org/net/mlo/duration");

                            SemanticPropertyModel propValorFInicio = Model.SemanticFrom.GetPropertyByPath("http://purl.org/net/mlo/start");
                            SemanticPropertyModel propValorFFinal = Model.SemanticFrom.GetPropertyByPath("http://onto.didactalia.net/emlo#end");


                            string valorPrecio = "";
                            string urlValorPrecio = "";
                            if (propValorPrecio != null)
                            {
                                valorPrecio = propValorPrecio.FirstPropertyValue.Value.Replace(" €", "");
                                urlValorPrecio = Comunidad.Url + "/recursos?rdf:type=course&gr:hasPriceSpecification=" + valorPrecio;
                            }

                            string valorFormato = "";
                            if (propValorFormato != null)
                            {
                                valorFormato = propValorFormato.FirstPropertyValue.Value;
                            }

                            string valorImagenCurso = "";
                            if (propValorImagenCurso != null)
                            {
                                valorImagenCurso = propValorImagenCurso.FirstPropertyValue.Value;
                            }

                            string valorDuracion = "";
                            string urlValorDuracion = "";
                            if (propValorDuracion != null)
                            {
                                valorDuracion = propValorDuracion.FirstPropertyValue.Value;
                                urlValorDuracion = Comunidad.Url + "/recursos?rdf:type=course&mlo:duration=" + valorDuracion;
                            }

                            string valorFInicio = "";
                            if (propValorFInicio != null)
                            {
                                valorFInicio = propValorFInicio.FirstPropertyValue.Value;
                            }

                            string valorFFinal = "";
                            if (propValorFFinal != null)
                            {
                                valorFFinal = propValorFFinal.FirstPropertyValue.Value;
                            }                               
                        }

                        <div class="cabeceraCurso clearfix">
                            <div class="fotoCurso col-xs-12 col-md-4">
                                <img src="@ViewBag.BaseUrlContent/@valorImagenCurso" />
                            </div>
                            <div class="datosBasicosCurso col-xs-12 col-md-8">
                                <div class="row duracion">
                                    <div class="col1 col-xs-12 col-md-6">
                                        <span class="icono"></span>
                                        <strong>@Html.Translate("Duración")</strong>
                                    </div>
                                    <div class="col2 col-xs-12 col-md-6">
                                        <span class="icono"></span>
                                        <a href="@urlValorDuracion">@valorDuracion @Html.Translate("horas")</a>
                                    </div>
                                </div>
                                <div class="row fechas">
                                    <div class="col1 col-xs-12 col-md-6">
                                        <span class="icono"></span>
                                        <strong>@Html.Translate("Fechas")</strong>
                                    </div>
                                    <div class="col2 col-xs-12 col-md-6">
                                        <span class="fechainicio"><strong>@Html.Translate("Fecha prevista inicio - ")</strong>@valorFInicio</span>
                                        <span class="fechafinal"><strong>@Html.Translate("Fecha prevista fin - ")</strong>@valorFFinal</span>
                                    </div>
                                </div>
                                <div class="row precio">
                                    <div class="col1 col-xs-12 col-md-6">
                                        <span class="icono"></span>
                                        <strong>@Html.Translate("Precio")</strong>
                                    </div>
                                    <div class="col2 col-xs-12 col-md-6">
                                        <a href="@urlValorDuracion">@valorPrecio €</a>
                                    </div>
                                </div>
                                <div class="rowButton">
                                    <a class="addToCart" href="#" rel="@FichaDocumento.Key" subtitulo="" title="@FichaDocumento.Title" precio="@valorPrecio"  formato="@valorFormato" default-text='@Html.Translate("Añadir")' active-text='@Html.Translate("Añadido")'><span class="icono"></span><span class="literal">@Html.Translate("Añadir")</span></a>
                                </div>                                
                                
                            </div>
                        </div>

                        @{
                            string objetivos = semCmsModel.GetFirstValuePropertyByPath("http://purl.org/net/mlo/objective");

                            if (!string.IsNullOrEmpty(objetivos))
                            {
                                <div class="objetivosCurso clearfix">
                                    <h3>@Html.Translate("Objetivos")</h3>
                                    <span @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://purl.org/net/mlo/objective"))>@Html.Raw(objetivos)</span>
                                </div>
                            }

                            string programa = semCmsModel.GetFirstValuePropertyByPath("http://onto.didactalia.net/emlo#program");

                            if (!string.IsNullOrEmpty(programa))
                            {
                                 
                                <div class="programaCurso clearfix">
                                    <h3>@Html.Translate("Programa")</h3>
                                    <div class="datosBasicosModulos col-xs-12" @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://onto.didactalia.net/emlo#program"))> @Html.Raw(programa)</div>                         
                                </div>
                                
                                        <!-- <div class="programaCurso clearfix">
                                    <h3>@Html.Translate("Programa")</h3>
                                    <div class="datosBasicosModulos col-xs-12">
                                        <div class="row">
                                            <div class="col1 col-xs-12 col-md-6">
                                                <span class="icono"></span>
                                                <strong>@Html.Translate("Modulo 1")</strong>
                                            </div>
                                            <div class="col2 col-xs-12 col-md-6">
                                                <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam commodo sagittis ex, eu efficitur tellus molestie eget. Integer quis lacinia tellus, at lacinia est. Etiam ac libero ac nunc pretium finibus consectetur in nibh. Nulla accumsan elementum sem hendrerit posuere. Cras pretium nisi in dui ornare, a efficitur mauris mattis. Nunc vitae neque eros. Duis eget sollicitudin nunc.</span>
                                            </div>
                                        </div>     
                                        <div class="row">
                                            <div class="col1 col-xs-12 col-md-6">
                                                <span class="icono"></span>
                                                <strong>@Html.Translate("Modulo 2")</strong>
                                            </div>
                                            <div class="col2 col-xs-12 col-md-6">
                                                <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam commodo sagittis ex, eu efficitur tellus molestie eget. Integer quis lacinia tellus, at lacinia est. Etiam ac libero ac nunc pretium finibus consectetur in nibh. Nulla accumsan elementum sem hendrerit posuere. Cras pretium nisi in dui ornare, a efficitur mauris mattis. Nunc vitae neque eros. Duis eget sollicitudin nunc.</span>
                                            </div>
                                        </div> 
                                        <div class="row">
                                            <div class="col1 col-xs-12 col-md-6">
                                                <span class="icono"></span>
                                                <strong>@Html.Translate("Modulo 3")</strong>
                                            </div>
                                            <div class="col2 col-xs-12 col-md-6">
                                                <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam commodo sagittis ex, eu efficitur tellus molestie eget. Integer quis lacinia tellus, at lacinia est. Etiam ac libero ac nunc pretium finibus consectetur in nibh. Nulla accumsan elementum sem hendrerit posuere. Cras pretium nisi in dui ornare, a efficitur mauris mattis. Nunc vitae neque eros. Duis eget sollicitudin nunc.</span>
                                            </div>
                                        </div> 
                                        <div class="row">
                                            <div class="col1 col-xs-12 col-md-6">
                                                <span class="icono"></span>
                                                <strong>@Html.Translate("Modulo 4")</strong>
                                            </div>
                                            <div class="col2 col-xs-12 col-md-6">
                                                <span>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam commodo sagittis ex, eu efficitur tellus molestie eget. Integer quis lacinia tellus, at lacinia est. Etiam ac libero ac nunc pretium finibus consectetur in nibh. Nulla accumsan elementum sem hendrerit posuere. Cras pretium nisi in dui ornare, a efficitur mauris mattis. Nunc vitae neque eros. Duis eget sollicitudin nunc.</span>
                                            </div>
                                        </div> 
                                    </div>                         
                                </div>-->
                            }


                            SemanticPropertyModel propDestinatarios = semCmsModel.GetPropertyByPath("http://onto.didactalia.net/emlo#learner");
                            string requisitos = semCmsModel.GetFirstValuePropertyByPath("http://purl.org/net/mlo/prerequisite");
                            string modalidad = semCmsModel.GetFirstValuePropertyByPath("http://purl.org/dc/elements/1.1/type");

                            if (propDestinatarios != null || !string.IsNullOrEmpty(requisitos) || !string.IsNullOrEmpty(modalidad))
                            {
                                <div class="informacionCurso clearfix">
                                    <h3>@Html.Translate("Información del curso")</h3>
                                    <div class="datosBasicosInformacion col-xs-12">


                                        @if (propDestinatarios != null && propDestinatarios.PropertyValues != null && propDestinatarios.PropertyValues.Count() > 0)
                                        {
                                             <div class="row">
                                                <div class="col1 col-xs-12 col-md-6">
                                                    <span class="icono"></span>
                                                    <strong>@Html.Translate("Destínatarios")</strong>
                                                </div>
                                                 <div class="col2 col-xs-12 col-md-6">
                                                     @foreach (SemanticPropertyModel.PropertyValue destinatario in propDestinatarios.PropertyValues)
                                                     {
                                                         string urlValorDestinatario = Comunidad.Url + "/recursos?rdf:type=course&emlo:learner=" + destinatario.Value;
                                                         <span @Html.Raw(semCmsModel.GetRDFAProperty(destinatario.Property))><a href="@urlValorDestinatario">@destinatario.Value</a></span>
                                                         
                                                         if (!destinatario.Equals(propDestinatarios.PropertyValues.Last()))
                                                         { 
                                                             <br/>
                                                         }
                                                     }
                                                 </div>
                                               
                                            </div>   
                                        }
                                          
                                        @if (!string.IsNullOrEmpty(requisitos))
                                        {
                                              <div class="row">
                                                <div class="col1 col-xs-12 col-md-6">
                                                    <span class="icono"></span>
                                                    <strong>@Html.Translate("Requisitos para el buen aprovechamiento del curso")</strong>
                                                </div>
                                                <div class="col2 col-xs-12 col-md-6">
                                                    <span @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://purl.org/net/mlo/prerequisite"))>@Html.Raw(requisitos)</span>
                                                </div>
                                            </div> 
                                        }
                                       
                                         @if (!string.IsNullOrEmpty(modalidad))
                                         {
                                            string urlValorModalidad = Comunidad.Url + "/recursos?rdf:type=course&dc:type=" + modalidad;
                                            <div class="row">
                                                <div class="col1 col-xs-12 col-md-6">
                                                    <span class="icono"></span>
                                                    <strong>@Html.Translate("Modalidad")</strong>
                                                </div>
                                                <div class="col2 col-xs-12 col-md-6">
                                                    <span @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://purl.org/dc/elements/1.1/type"))><a href="@urlValorModalidad">@modalidad</a></span>
                                                </div>
                                            </div>  
                                         }
                                    </div>   
                                </div>
                            }


                            string nombreFormador = semCmsModel.GetFirstValuePropertyByPath("http://onto.didactalia.net/emlo#issuerName");
                            string imagenFormador = semCmsModel.GetFirstValuePropertyByPath("http://onto.didactalia.net/emlo#issuerImage");
                            string descripcionFormador = semCmsModel.GetFirstValuePropertyByPath("http://onto.didactalia.net/emlo#issuerDescription");


                            if (!string.IsNullOrEmpty(nombreFormador))
                            {
                                string urlValorFormador = Comunidad.Url + "/recursos?rdf:type=course&emlo:issuerName=" + nombreFormador;
                                  <div class="formadorCurso clearfix">
                                    <h3>@Html.Translate("Formador")</h3>
                                    <div class="profesorCurso col-xs-12 col-md-4">                                       
                                        <p class="nombreProfesor" @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://onto.didactalia.net/emlo#issuerName"))><a href="@urlValorFormador">@nombreFormador</a></p>

                                        @if (!string.IsNullOrEmpty(imagenFormador))
                                        {
                                           <span @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://onto.didactalia.net/emlo#issuerDescription"))><img src="@ViewBag.BaseUrlContent/@imagenFormador"/></span>
                                        }
                                        
                                    </div>

                                    <div class="datosProfesorCurso col-xs-12 col-md-8">
                                         @if (!string.IsNullOrEmpty(descripcionFormador))
                                         {
                                              <p class="nombreProfesor" @Html.Raw(semCmsModel.GetRDFAPropertyByPath("http://onto.didactalia.net/emlo#issuerImage"))>@Html.Raw(descripcionFormador)</p>
                                         }
                                    </div>                                
                                </div> 
                            } 
                        }
                       
                        <script type="text/javascript">
                            $(document).ready(function () {
                                MontarFechas();

                                cargarGadgets();
                            });

                            function cargarGadgets() {
                                var gadgets = "";
                                $('#divContPanGadgets div.group.resources:empty').each(function () {
                                    if ($(this).attr("id") != undefined && $(this).attr("id") != "") {
                                        gadgets += $(this).attr("id") + ",";
                                    }
                                });

                                if (gadgets != "") {
                                    var dataPostGadgets = {
                                        callback: "CargarGadgets",
                                        gadgetsID: gadgets
                                    }

                                    $.post('@ViewBag.UrlPagina', dataPostGadgets, function (data) {
                                        for (var i in data) {
                                            if (data[i].updateTargetId.indexOf("FichaGadget_") == 0) {
                                                var panID = data[i].updateTargetId.substr(12);
                                                var htmlGadget = data[i].html;
                                                if (htmlGadget == "") {
                                                    $('#divContPanGadgets').find("#" + panID).remove();
                                                }
                                                else {
                                                    $('#divContPanGadgets').find("#" + panID).replaceWith(htmlGadget);
                                                }
                                            }
                                        }
                                        cargarGadgets();
                                    });
                                }
                                else {
                                    customizarCol01DivDoblePestana.init();
                                }
                            }

                            @if (FichaDocumento.Graphs.Count > 0)
                            {
                                @:var urlPaginaCallBackGrafos = '@FichaDocumento.ListActions.UrlCallbackGraph';
                                                                                                                                                                                                                                                                                                                            
                                Guid docID = FichaDocumento.Key;
                                string tituloGrafo = FichaDocumento.Title.Replace("'", "\\'");
                                Guid proyID = Comunidad.Key;
                                string UrlIntragnoss = Model.UrlIntragnoss;

                                ViewBag.ListaJS.Add(ViewBag.BaseURL + "/jsweb/arbor.js?v=" + ViewBag.Version);
                                ViewBag.ListaJS.Add(ViewBag.BaseURLStatic + "/jsNuevo/grafos/js/grafo.gnoss.js?v=" + ViewBag.Version);
                                ViewBag.ListaJS.Add(ViewBag.BaseURLStatic + "/jsNuevo/grafos/js/jquery.qtip.min.js?v=" + ViewBag.Version);
                                ViewBag.ListaCSS.Add(ViewBag.BaseURLStatic + "/jsNuevo/grafos/css/jquery.qtip.min.css?v=" + ViewBag.Version);

                                foreach (ResourceModel.GrafoRecurso grafo in FichaDocumento.Graphs)
                                {
                                    @Html.Raw(" var dataPost = {urlintragnoss: '" + UrlIntragnoss + "', propEnlace: '" + grafo.PropEnlace + "', nodosLimiteNivel: 30,extra: '" + grafo.Extra + "', idioma: $('input.inpt_Idioma').val(), tipoRecurso: '" + grafo.TipoRecurso + "'};");

                                    @Html.Raw(" $(function(){MontarGrafoFicRec('" + docID + "', '" + tituloGrafo + "', '" + proyID + "', '" + grafo.PropEnlace + "', 30, '" + UrlIntragnoss + "', '" + grafo.Extra + "', '" + grafo.UrlBusqueda + "', '" + grafo.TipoRecurso + "'); GnossPeticionAjax('" + FichaDocumento.ListActions.UrlLoadGraph + "', dataPost, true).done(function(data){FinTraerDatosGrafoAJAX(data)});});");
                                }
                            }
                        </script>

                        @if (FichaDocumento.TypeDocument != ResourceModel.DocumentType.Semantico)
                        {
                            @Html.PartialView("_FichaDescripcion", FichaDocumento)
                        }

                        @if (Model.SemanticFrom != null && !Model.SemanticFrom.SemCmsDrawOverMenu)
                        {
                            @Html.PartialView("../Shared/SemCms/_GeneradorSemCms", Model.SemanticFrom);
                        }

                        @if (FichaDocumento.Graphs.Count > 0)
                        {
                        <div class="group grafo-relaciones" style="display:none">
                            <p class="group-title">Mapa Conceptual sobre @FichaDocumento.Title</p>
                            <a class="lanzarVentana" href="#">Ver grafo a pantalla completa</a>
                            <div id="divContGrafo"></div>
                            <div>
                                <div>
                                    <div class="leyendaGrafo" id="leyendaGrafo">
                                        <p class="presentacion">Este mapa de relaciones está construido utilizando los contenidos y la ontología de DBpedia (Wikipedia semántica) y permite enriquecer los contenidos educativos de Didactalia, ofreciendo un uso educativo de Wikipedia, y vivecersa.</p>
                                        <ul>
                                            <li class="item01"><span></span>Recursos de Didactalia</li>
                                            <li class="item02"><span></span>Entidades relacionadas de Wikipedia</li>
                                            <li class="item03"><span></span>Definiciones de Wikipedia</li>
                                        </ul>
                                    <p>Esta página contiene enlaces y contenidos de Wikipedia. Didactalia no puede garantizar que los recursos educativos de la comunidad no convoquen algún <a style="text-decoration:underline" target="_blank" href="http://es.wikipedia.org/wiki/Wikipedia:Aviso_de_contenido">contenido ofensivo o inadecuado de Wikipedia</a>. En caso de existir alguno, Didactalia emprenderá las acciones precisas para eliminarlo en el menor tiempo posible. Si detectan algún contenido inapropiado puede comunicarse a <a style="text-decoration:underline" href="mailto: didactalia@didactalia.net">didactalia@didactalia.net</a>. Para más información ver: <a style="text-decoration:underline" target="_blank" href="https://didactalia.net/comunidad/materialeducativo/condiciones-uso#Responsabilidades">Condiciones de Uso de Didactalia.</a></p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        }                        

                        @if (!Model.HideUtilsResource)
                        {
                            <div class="group utils-2" id="contAutoresEditoresLectores">
                                @Html.PartialView("_FichaAutoresEditoresLectores", FichaDocumento)
                            </div>
                        }

                        @Html.PartialView("_FichaEtiquetas", FichaDocumento)

                        @if (FichaDocumento.Version > 0)
                        {
                            <div class="group version">
				                <p>
				                    @Html.GetText("LISTARECURSOS", "VERSIONES")@FichaDocumento.Version
				                </p> 
			                </div>
                        }
                        @if (FichaDocumento.Licence != "")
                        {
                            <div class="group license">
                                <p class="licencia creativeCommonds">@Html.Raw(FichaDocumento.Licence)</p>
                            </div>
                        }
                    </div>
                </div>
            </div>
        </div>
    </div>
    @if (FichaDocumento.Comments != null)
    {
        <div class="resource-comments">
            <div class="box comments" id="comments">
                <div class="commentsTop input-group">
                    <div class="comentariosLiteral">
                        <p>Comentar</p>
                    </div>  
                    <div class="totalComentarios">
                        <p class="what"><span class="icono"></span>@FichaDocumento.NumComments</p>
                    </div>				
				</div>
				@if (!IdentidadActual.IsGuestIdentity)
    {
        if (FichaDocumento.AllowComments)
        {
            ViewBag.ListaJS.Add(ViewBag.BaseURL + "/ckeditor/ckeditor.js?v=" + ViewBag.Version);
            ViewBag.ListaJS.Add(ViewBag.BaseURL + "/ckeditor/adapters/jquery.js?v=" + ViewBag.Version);


            string urlFotoUsuario = "";
            if (string.IsNullOrEmpty(perfil.Foto))
            {
                urlFotoUsuario = Html.GetBaseUrlStatic() + "/personalizacion/theme/resources/anonimo_peque.png";
            }
            else
            {
                urlFotoUsuario = ViewBag.BaseUrlContent + perfil.Foto;
            }


            string urlUsuario = "";
            string nombreUsuario = perfil.Name;
						
						<div class="divEscribirComentario">
							<div class="userImage">
								<a class="userComment" href="@urlUsuario"><img src="@urlFotoUsuario"></a>
							</div>
							<div class="datosUsuario">
								<a href="@urlUsuario" typeof="foaf:Person"><span property="foaf:name">@nombreUsuario</span></a>
								<textarea class="cke comentarios" id="txtNuevoComentario_@FichaDocumento.Key" rows="2" cols="20"></textarea>
								@{
            string funcionComentario_CrearComentario = "Comentario_CrearComentario('" + FichaDocumento.ListActions.UrlCreateComment + "', '" + FichaDocumento.Key + "');"; 
								}
								<input type="button" class="text medium" value="@Html.GetText("COMMON", "ENVIAR") >" onclick="@funcionComentario_CrearComentario" />
							</div>
						</div>
        }
        else
        {
						<label><span>@Html.GetText("CONTROLESDOCUMENTACION", "COMENTARIOSBLOQUEADOS")</span></label>
        }
    }
    else
    {   
				<div class="inicioSesionComentarios">
                    <p>@Html.GetText("CONTROLESDOCUMENTACION", "QUIERESCOMENTAR") <a href="@Comunidad.Url/@Html.GetText("URLSEM", "HAZTEMIEMBRO")">@Html.GetText("COMMON", "REGISTRARSE")</a> @Html.GetText("PERFIL", "VISITANTEPERFILO") <a href="@Comunidad.Url/@Html.GetText("URLSEM", "LOGIN")">@Html.GetText("COMINICIOLOGIN", "INICIASESION")</a></p>
                </div>
    }
				<div id="panComentarios">
				@foreach (CommentModel comentario in FichaDocumento.Comments)
    {
					@Html.PartialView("_FichaComentario", comentario)
    }
				</div>
				@if (FichaDocumento.Comments.Count > 2)
    {
				<div class="desplegarComentarios">
                    <span class="literal">Ver todos<span class="icono"></span></span>
                </div>
                 
    }
            </div>
        </div>
    }
</div>
<div id="col01" class="col col-xs-12 col-md-3">
	@if (ViewBag.FormularioRegistro != null)
 {
		<div>
			@Html.PartialView("_FormularioRegistroShared", (AutenticationModel)(ViewBag.FormularioRegistro))
		</div>
 }
	<div id="panVinculadosInt">
        @Html.PartialView("_FichaVinculados", FichaDocumento)
    </div>
    @if (FichaDocumento.Gadgets != null && FichaDocumento.Gadgets.Count > 0)
    {
        <div id="divContPanGadgets" class="recursosGadgets">
            @foreach (GadgetModel gadget in ((List<GadgetModel>)FichaDocumento.Gadgets).OrderBy(gadget => gadget.Order))
            {
                @Html.PartialView("ControlesMVC/_FichaGadget", gadget)
            }
        </div>
    }
</div>

<div id="palco" class="palco @FichaDocumento.RdfType" style="display: none;">
    <div class="palcoHead">
        <div class="headRow01 input-group">
            <div class="corporativo btn btn-default btn-descubre input-group-btn" id="corporativo">
                <div class="content ">
                    <div class="logoCustomRIAM">
						<a href="@Comunidad.Url">                                
							<img style="height:21px;" src="@ViewBag.BaseUrlStatic/personalizacion/theme/resources/logo-didactalia-blanco-movil.png" title="@Comunidad.Name" alt="@Comunidad.Name" class="logoMovil" />
						</a>
					</div>
                </div>
            </div>
            <div class="webSiteTitle btn btn-default btn-descubre input-group-btn" id="webSiteTitle">
                <h2>
                    @if (string.IsNullOrEmpty(FichaDocumento.UrlDocument))
                    {
                        @FichaDocumento.Title
                    }
                    else
                    {
                        string claseEnviarAccGogAnac = "";
                        if (FichaDocumento.TypeDocument == Es.Riam.Gnoss.Web.MVC.Models.ResourceModel.DocumentType.Imagen || FichaDocumento.TypeDocument == Es.Riam.Gnoss.Web.MVC.Models.ResourceModel.DocumentType.FicheroServidor)
                        {
                            claseEnviarAccGogAnac = "class=\"linkDescargaFichero\"";
                        }

                        if (FichaDocumento.OpenInNewWindow)
                        {
                            @FichaDocumento.Title
                        }
                        else
                        {
                            @FichaDocumento.Title
                        }
                    }
                </h2>
            </div>
            <div class="closeButton btn btn-default btn-descubre input-group-btn" id="closeButton">
                <a href="#" class="cerrar">x</a>
            </div>            
        </div>
    </div>
    <div class="grafoContent"></div>
</div>
